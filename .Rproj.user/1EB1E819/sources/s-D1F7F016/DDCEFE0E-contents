userstats <- function(user, n=1000){
  user <- deparse(substitute(user))
  n <- deparse(substitute(n))
  # read in the template and modify it
  report <- readLines("userstatsTemplate.txt")
  report <- gsub("xxxnum", n, report, fixed = TRUE)
  report <- gsub("xxxuser", user, report, fixed = TRUE)

  # write out template
  tf <- tempfile(fileext = ".Rmd")
  to <- tempfile(fileext = ".Html")
  writeLines(report, tf)

  # render R markdown and display
  library(rmarkdown)
  render(input = tf,
         output_format = "html_document",
         output_file = to)
  file.show(to)

  invisible(to)
}

userstats("taylorswift13",3200)
